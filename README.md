# Transformer

## 1. Encoder

+ 运行demo：python encoder_text_classification.py

+ 查看函数详情：Encoder_test.ipynb

```python

==================================================================================================
input_1 (InputLayer)            [(None, 64)]         0
__________________________________________________________________________________________________
tf_op_layer_Equal (TensorFlowOp [(None, 64)]         0           input_1[0][0]
__________________________________________________________________________________________________
tf_op_layer_Cast (TensorFlowOpL [(None, 64)]         0           tf_op_layer_Equal[0][0]
__________________________________________________________________________________________________
embedding (Embedding)           (None, 64, 128)      2560000     input_1[0][0]
__________________________________________________________________________________________________
tf_op_layer_strided_slice (Tens [(None, 1, 1, 64)]   0           tf_op_layer_Cast[0][0]
__________________________________________________________________________________________________
encoder (Encoder)               (None, 64, 128)      264960      embedding[0][0]
                                                                 tf_op_layer_strided_slice[0][0]
__________________________________________________________________________________________________
global_average_pooling1d (Globa (None, 128)          0           encoder[0][0]
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 128)          0           global_average_pooling1d[0][0]
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 128)          0           dropout_4[0][0]
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 128)          0           dropout_5[0][0]
__________________________________________________________________________________________________
dense_14 (Dense)                (None, 2)            258         dropout_6[0][0]
==================================================================================================
Total params: 2,825,218
Trainable params: 2,825,218
Non-trainable params: 0
__________________________________________________________________________________________________

```


## 2. Decoder


### 参考：

+ https://github.com/czy36mengfei/tensorflow2_tutorials_chinese/tree/master/026-Transformer